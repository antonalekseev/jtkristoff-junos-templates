interfaces <*> {
    unit <*> {
        family <*> {
            filter {
                input-list [ ... ];
            }
        }
    }
}

firewall {
    family inet {
        filter count-packets {
            term default-allow {
                then next term;
        filter unwanted-bgp-mren-re {
            term default-allow {
                then next term;
        filter unwanted-bgp-mren-i2trcps {
            term default-allow {
                then next term;
        filter unwanted-packets {
            term bogons {
            term icmp-types {
            term ip-protocols {
            term printing-apps {
            term default-allow {
                then next term;
        filter ratelimit-ge {
            term udp {
                from {
                    protocol udp;
                }
                then {
                    count udp;
                    policer ge-50percent;
                    sample;
                    next term;
                }
            }
            term icmp {
                from {
                    protocol icmp;
                }
                then {
                    count icmp;
                    policier ge-5percent;
                    sample;
                    next term;
                }
            }
            term default {
                then {
                    count default;
                    sample;
                    next term;
                }
            }
        }
        filter ratelimit-xe {
            term udp {
                from {
                    protocol udp;
                }
                then {
                    count udp;
                    policer xe-50percent;
                    sample;
                    next term;
                }
            }
            term icmp {
                from {
                    protocol icmp;
                }
                then {
                    count icmp;
                    policier xe-5percent;
                    sample;
                    next term;
                }
            }
            term default {
                then {
                    count default;
                    sample;
                    next term;
                }
            }
        }
        [...]
    family inet6 {
        filter count-v6-packets {
            term default-allow {
                then next term;
        filter unwanted-v6-bgp-mren-re {
            term default-allow {
                then next term;
        filter unwanted-v6-bgp-mren-i2trcps {
            term default-allow {
                then next term;
        filter unwanted-v6-packets {
            term bogons {
            term icmp-types {
            term ip-protocols {
            term printing-apps {
            term default-allow {
                then next term;
        filter ratelimit-ge {
            term udp {
                from {
                    payload-protocol udp;
                }
                then {
                    count udp;
                    policer ge-50percent;
                    sample;
                    next term;
                }
            }
            term icmp {
                from {
                    payload-protocol icmp;
                }
                then {
                    count icmp;
                    policier ge-5percent;
                    sample;
                    next term;
                }
            }
            term default {
                then {
                    count default;
                    sample;
                    next term;
                }
            }
        }
        filter ratelimit-xe {
            term udp {
                from {
                    payload-protocol udp;
                }
                then {
                    count udp;
                    policer xe-50percent;
                    sample;
                    next term;
                }
            }
            term icmp {
                from {
                    payload-protocol icmp;
                }
                then {
                    count icmp;
                    policier xe-5percent;
                    sample;
                    next term;
                }
            }
            term default {
                then {
                    count default;
                    sample;
                    next term;
                }
            }
        }
        [...]

    policer ge-5percent {
        if-exceeding {                  
            bandwidth-limit 50m;        
            burst-size-limit 500k;        
        }                               
        then discard;                   
    }
    policer ge-50percent {
        if-exceeding {
            bandwidth-limit 500m;
            burst-size-limit 50m;
        }
        then discard;
    }
    policer xe-5percent {
        if-exceeding {
            bandwith-limit 500m;
            burst-size-limit 5m;
        }
        then discard;
    }
    policer xe-50percent {
        if-exceeding {
            bandwith-limit 5g;
            burst-size-limit 500m ;
        }
    }
}
